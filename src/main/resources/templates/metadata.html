<html>

<head>
    <script th:src="@{/js/jquery.min.js}"></script>
    <script th:src="@{/js/jquery-1.12.4.js}"></script>
    <script th:src="@{/js/jquery-ui.js}"></script>
    <script th:src="@{/js/commonjs.js}"></script>
    <link href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <style>
		table {
			border-collapse: collapse;
		}

		th,
		td {
			border: none;
			padding: 10px;
			text-align: left;
			min-width: 70px;
			max-width: 150px;
			overflow: auto;
			white-space: nowrap;
		}

		a {
			color: black;
		}

    </style>
</head>

<body>

<div th:replace="header"></div>

<div class="main">
    <div class="explorer"
         style="width: 250px; height:100%; float: left; background-color:rgb(246, 246, 246); overflow-x: scroll;">
        <div class="global_fields_label" style="width:100%; cursor: pointer; background-color:rgb(220, 220, 220)">Global
            Category Fields
        </div>
        <div class="global_fields"></div>
        <br>
        <br>
        <div class="entities_label" style="width:100%; cursor: pointer; background-color:rgb(220, 220, 220)">Entities
        </div>
        <div class="entities"></div>
        <br>
        <br>
        <div class="type_definitions_label" style="width:100%; cursor: pointer; background-color:rgb(220, 220, 220)">
            Type Definitions
        </div>
        <div class="type_definitions"></div>
    </div>
    <div class="reference" style="height:100%; overflow-y: scroll;">
        <div class="content" style="margin-left: 10px; overflow-x: scroll;">
            <div class="EntityTable" style="margin-top: -10px; display: none;"></div>
            <div class="AddEntityButtons" style="margin-top: 10px">
                <input id="AddEntityButton" style="display: none; margin-left: 0px;" type="button" value="Add Entity">
                <input id="SaveEntityButton" style="display: none; margin-left: 10px;" type="button" value="Save">
            </div>
            <div class="TypeTable" style="margin-top: -10px; display: none;"></div>
            <div class="AddTypeButtons" style="margin-top: 10px">
                <input id="AddTypeButton" style="display: none; margin-left: 0px;" type="button" value="Add Type">
                <input id="SaveTypeButton" style="display: none; margin-left: 10px;" type="button" value="Save">
            </div>
        </div>
        <div class="AddFieldButtons" style="margin: 10px 10px;">
            <input id="AddFieldButton" style="display: none; margin: 0;" type="button" value="Add Field">
            <input id="SaveFieldButton" style="display: none; margin: 10px 10px;" type="button" value="Save">
        </div>
    </div>
</div>

<div style="display: none;">
    <ul class="UlRef" style="padding-left: 18px">
        <li></li>
    </ul>
</div>

<div class="GlobalFieldTableRef" style="margin-top: -10px; display: none;">
    <table>
        <thead>
        <tr>
            <th class="serial" style="display: none;">Serial</th>
            <th class="fieldname">Field Name</th>
            <th class="displayname">Display Name</th>
            <th class="description">Description</th>
            <th class="type">Type</th>
            <th class="values">Enum Values</th>
            <th class="updatedate" style="display: none;">Update Date</th>
            <th class="createdate" style="display: none;">Create Date</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td class="serial" style="display: none;"></td>
            <td class="fieldname"></td>
            <td class="displayname"></td>
            <td class="description"></td>
            <td class="type"></td>
            <td class="values"></td>
            <td class="updatedate" style="display: none;"></td>
            <td class="createdate" style="display: none;"></td>
        </tr>
        </tbody>
    </table>
</div>

<div class="FieldTableRef" style="margin-top: -10px; display: none;">
    <table>
        <thead>
        <tr>
            <th class="serial" style="display: none;">Serial</th>
            <th class="fieldname">Field Name</th>
            <th class="displayname">Display Name</th>
            <th class="description">Description</th>
            <th class="type">Type</th>
            <th class="subtype" style="display: none;">Sub Type</th>
            <th class="association_type" style="display: none;">Association Type</th>
            <th class="values" style="display: none;">Enum Values</th>
            <th class="fieldlevel">Field Level</th>
            <th class="required">Required</th>
            <th class="updatedate" style="display: none;">Update Date</th>
            <th class="createdate" style="display: none;">Create Date</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td class="serial" style="display: none;"></td>
            <td class="fieldname"></td>
            <td class="displayname"></td>
            <td class="description"></td>
            <td class="type"></td>
            <td class="subtype" style="display: none;"></td>
            <td class="association_type" style="display: none;"></td>
            <td class="values" style="display: none;"></td>
            <td class="fieldlevel"></td>
            <td class="required"></td>
            <td class="updatedate" style="display: none;"></td>
            <td class="createdate" style="display: none;"></td>
        </tr>
        </tbody>
    </table>
</div>

<div class="AddEntity" style="display: none;">
    <table>
        <thead>
        <tr>
            <th style="display: none;">Serial</th>
            <th>Entity Name</th>
            <th>Display Name</th>
            <th>Description</th>
            <th class="updatedate" style="display: none;">Update Date</th>
            <th class="createdate" style="display: none;">Create Date</th>
        </tr>
        </thead>
        <tbody>
        <tr class="entityRow" style="display: none;">
            <td class="serial" style="display: none;"></td>
            <td class="entityname"></td>
            <td class="displayname"></td>
            <td class="description"></td>
            <td class="updatedate" style="display: none;"></td>
            <td class="createdate" style="display: none;"></td>
        </tr>
        </tbody>
    </table>
</div>

<div class="AddType" style="display: none;">
    <table>
        <thead>
        <tr>
            <th style="display: none;">Serial</th>
            <th>Type Name</th>
            <th>Display Name</th>
            <th>Description</th>
            <th class="updatedate" style="display: none;">Update Date</th>
            <th class="createdate" style="display: none;">Create Date</th>
        </tr>
        </thead>
        <tbody>
        <tr class="typeRow" style="display: none;">
            <td class="serial" style="display: none;"></td>
            <td class="typename"></td>
            <td class="displayname"></td>
            <td class="description"></td>
            <td class="updatedate" style="display: none;"></td>
            <td class="createdate" style="display: none;"></td>
        </tr>
        </tbody>
    </table>
</div>

<div class="input" style="display: none;">
    <span></span>
    <input style="margin:0;" type="text"/>
    <select class="type">
        <option value="string">String</option>
        <option value="float">Float</option>
        <option value="double">Double</option>
        <option value="integer">Integer</option>
        <option value="long">Long</option>
        <option value="date">Date</option>
        <option value="boolean">Boolean</option>
        <option value="enum">Enum</option>
        <option value="array">Array</option>
        <option value="object">Object</option>
        <option value="file">File</option>
    </select>
    <select class="subtype">
        <option value=""></option>
        <option value="string">String</option>
        <option value="float">Float</option>
        <option value="double">Double</option>
        <option value="integer">Integer</option>
        <option value="long">Long</option>
        <option value="date">Date</option>
        <option value="boolean">Boolean</option>
        <option value="object">Object</option>
        <option value="file">File</option>
    </select>
    <select class="association_type">
        <option value=""></option>
        <option value="many_to_many">Many-To-Many</option>
        <option value="many_to_one">Many-To-One</option>
    </select>
    <select class="boolean">
        <option value="false">False</option>
        <option value="true">True</option>
    </select>
    <select class="fieldlevel">
        <option value="none">None</option>
        <option value="primary">Primary</option>
        <option value="query">Query</option>
    </select>
</div>

<div class="edit" style="display:none;">
		<span class="edit" style="display:none; padding:3px; cursor:pointer;" title="Edit">
			<img alt="edit" height="12" th:src="@{/images/icon-pencil.png}" width="12">
		</span>
    <span class="save" style="display:none; padding:2px; cursor:pointer;" title="Save">
			<img alt="save" height="14" th:src="@{/images/icon-checkmark.png}" width="14">
		</span>
    <span class="info" style="display:none; padding:2px; cursor:pointer; margin-left: 2px" title="Info">
			<img alt="info" height="13" th:src="@{/images/icon-info.png}" width="13">
		</span>
</div>

<div id="dialog-form" title="Create localized meta document">
    <p class="validateTips">All fields are required.</p>
    <form>
        <fieldset>
            <!-- Allow form submission with keyboard without duplicating the dialog button -->
            <input style="position:absolute; top:-1000px" tabindex="-1" type="submit">

            <label>Name</label>
            <input class="ui-widget-content ui-corner-all" type="text">
        </fieldset>
    </form>
</div>

</body>

<script th:src="@{/js/metascript.js}"></script>
<script th:inline="javascript" type="text/javascript">

	var client = /*[[${client}]]*/ "";
	var metadata = /*[[${metadata}]]*/ "";
	var localizations = /*[[${localizations}]]*/ "";
	var allowMultipleEntity = true;
	var metaBaseURL = "/v1/metadata/" + client;
	var ids = [];
	localizations.forEach(element => {
		ids.push(metadata[element].id);
	});
	var currentMetadata = metadata[localizations[0]];

	// populate dialog box
	var dialogFields = $("#dialog-form fieldset input[type=text], select");
	var dialog = setupDialogBox(dialogFields);

	// populate create button
	populateCreateButton();

	// load navigator
	loadToolbar(client, true, localizations, null);

	// Populate metadata
	loadMetadata(currentMetadata);

	// on localization value change
	$(".toolbar .localization select").selectmenu({
		change: function () {
			var localization = $(".toolbar .localization select").val();

			// refresh metadata
			currentMetadata = getMetadata(localization);
			
			metadata[localization] = currentMetadata;
			loadMetadata(currentMetadata);
		}
	});


</script>

</html>